# Требования к Workflow: Анализ PDF прайсов на линзы

## Основная задача
Бот в Telegram принимает PDF файл с прайсом на линзы, анализирует его и переносит данные в Google Sheets.

## Вопросы для уточнения

### 1. Структура данных в прайсе
**Какие поля нужно извлекать из прайса?**

Возможные поля:
- [ ] Название/модель линзы
- [ ] Артикул/SKU
- [ ] Производитель/бренд
- [ ] Цена (розничная)
- [ ] Цена (оптовая)
- [ ] Характеристики:
  - [ ] Материал (пластик, стекло, поликарбонат)
  - [ ] Покрытие (антиблик, защита от синего света, фотохром)
  - [ ] Индекс преломления
  - [ ] Диаметр
  - [ ] Кривизна базовой поверхности
- [ ] Наличие/остатки
- [ ] Категория (однофокальные, прогрессивные, мультифокальные, компьютерные)
- [ ] Срок изготовления
- [ ] Другие поля: _________________

### 2. Формат прайса
- [ ] Таблица в PDF
- [ ] Текстовый список
- [ ] Смешанный формат
- [ ] Есть изображения, которые нужно учитывать
- [ ] Обычное количество позиций: _______________

### 3. Структура Google Sheets
**Какие колонки должны быть в таблице?**

Предлагаемая структура:
| Колонка | Тип данных | Описание |
|---------|-----------|----------|
| Дата обработки | Дата/Время | Когда файл был обработан |
| Название линзы | Текст | Модель/название |
| Артикул | Текст | SKU/код товара |
| Производитель | Текст | Бренд |
| Цена розничная | Число | Розничная цена |
| Цена оптовая | Число | Оптовая цена |
| Материал | Текст | Материал линзы |
| Покрытие | Текст | Тип покрытия |
| Индекс преломления | Число | nD значение |
| Категория | Текст | Тип линзы |
| Наличие | Текст/Число | Остатки |
| Примечания | Текст | Дополнительная информация |

**Дополнительные требования:**
- [ ] Группировка по категориям
- [ ] Группировка по производителям
- [ ] Вычисляемые поля (суммы, средние)
- [ ] Фильтры
- [ ] Другое: _________________

### 4. Обработка файлов
- [ ] Обработка нескольких PDF в одном сообщении
- [ ] Обработка многостраничных PDF
- [ ] Валидация данных перед записью
- [ ] Обработка ошибок и уведомления пользователя

### 5. Дополнительные функции
- [ ] Уведомление об успешной обработке
- [ ] Логирование ошибок
- [ ] Обновление существующих записей (по артикулу)
- [ ] Только добавление новых записей
- [ ] Статистика обработки (сколько позиций обработано)

## Предполагаемая структура Workflow

1. **Telegram Trigger** - Прием PDF файла
2. **Extract PDF Data** - Извлечение текста/таблиц из PDF
3. **AI Agent** - Анализ и структурирование данных
4. **Data Validation** - Проверка и валидация данных
5. **Google Sheets** - Запись в таблицу

## Пример структуры JSON для AI

```json
{
  "items": [
    {
      "name": "Название линзы",
      "article": "Артикул",
      "manufacturer": "Производитель",
      "price_retail": 1500,
      "price_wholesale": 1200,
      "material": "Пластик",
      "coating": "Антиблик",
      "refractive_index": 1.6,
      "category": "Однофокальные",
      "stock": "В наличии",
      "notes": "Дополнительная информация"
    }
  ],
  "metadata": {
    "processed_at": "2025-11-22T12:00:00Z",
    "total_items": 50,
    "source_file": "price_list.pdf"
  }
}
```
